gg_exp_salary <- ggplot(data = dat, aes(x = experience, y = salary)) +
geom_point(aes(color = dat$team))
library(ggplot2)
gg_exp_salary <- ggplot(data = dat, aes(x = experience, y = salary)) +
geom_point(aes(color = dat$team))
gg_exp_salary
gg_exp_salary <- ggplot(data = dat, aes(x = experience, y = salary)) +
geom_point(aes(color = dat$team))
ggsave(filename = "/Users/Roberto/Desktop/133/stat133-hws-fall17/hw03/images/experience_salary.pdf", width = 6, height = 4)
gg_exp_salary
knitr::opts_chunk$set(echo = TRUE)
source('make-teams-table.R')
source('/Users/Roberto/Desktop/133/stat133-hws-fall17/hw03/code/make-teams-table.R')
knitr::opts_chunk$set(echo = TRUE)
source('/Users/Roberto/Desktop/133/stat133-hws-fall17/hw03/code/make-teams-table.R')
roster <- read.csv('/Users/Roberto/Desktop/133/stat133-hws-fall17/hw03/data/nba2017-roster.csv', stringsAsFactors = FALSE)
stats <- read.csv('/Users/Roberto/Desktop/133/stat133-hws-fall17/hw03/data/nba2017-stats.csv',stringsAsFactors = FALSE)
knitr::opts_chunk$set(echo = TRUE)
source('/Users/Roberto/Desktop/133/stat133-hws-fall17/hw03/code/make-teams-table.R')
stats <- read.csv('/Users/Roberto/Desktop/133/stat133-hws-fall17/hw03/data/nba2017-stats.csv',stringsAsFactors = FALSE)
summary(dat)
summary(dat)
summary(dat)
gg_exp_salary <- ggplot(data = dat, aes(x = experience, y = salary)) +
geom_point(aes(color = dat$team))
gg_exp_salary <- ggplot(data = dat, aes(x = experience, y = salary)) +
geom_point(aes(color = dat$team))
ggplot(data = dat, aes(x = experience, y = salary)) +
geom_point(aes(color = dat$team))
arrange(teams, desc(salary))
salartyD <- arrange(teams, desc(salary))
salaryD <- arrange(teams, desc(salary))
gg_salary <- ggplot(data = salaryD)
gg_salary
gg_salary <- ggplot(data = salaryD, aes(x =experience ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
gg_salary <- ggplot(data = teams, aes(x =experience ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
gg_salary <- ggplot(data = teams, aes(x =experience ,y =team)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
salaryD <- arrange(teams, desc(salary))
gg_salary <- ggplot(data = salaryD, aes(x =experience ,y =salary)) +
geom_bar(stat='identity')
gg_salary
gg_salary <- ggplot(data = salaryD, aes(x =experience ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
gg_salary <- ggplot(data = salaryD, aes(x =team ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
salaryD <- arrange(teams, desc(salary))
salaryD
gg_salary <- ggplot(data = salaryD, aes(x =experience ,y =desc(salary))) +
geom_bar(stat='identity') + coord_flip()
salaryD
salaryD
gg_salary
gg_salary <- ggplot(data = teams, aes(x =experience ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
gg_salary <- ggplot(data = salaryD, aes(x =experience ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
gg_salary <- ggplot(data = salaryD, aes(x =experience ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
gg_salary <- ggplot(data = salaryD, aes(x =teams ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
gg_salary <- ggplot(data = salaryD, aes(x =experience ,y =desc(salary))) +
geom_bar(stat='identity') + coord_flip()
geom_bar(stat='identity') + coord_flip()
gg_salary <- ggplot(data = salaryD, aes(x =experience ,y =desc(salary))) +
geom_bar(stat='identity') + coord_flip()
gg_salary
gg_salary <- ggplot(data = salaryD, aes(x =teams ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
salaryD <- arrange(teams, desc(salary))
gg_salary <- ggplot(data = salaryD, aes(x =experience ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
gg_salary <- ggplot(data = salaryD, aes(x =team ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
gg_salary <- ggplot(data = teams, aes(x =team ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
gg_salary <- ggplot(data = teams, aes(x =reorder(team, -salary) ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary)) +
geom_bar(stat='identity') + coord_flip()
gg_salary
reorder?
?
''
?reorder
temp <-
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary)) + labs(x= Teams, y = Salary) +
geom_bar(stat='identity') + coord_flip()
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary)) + labs(x= Teams, y = Salary) +
geom_bar(stat='identity') + coord_flip()
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip()
gg_salary
geom_vline()
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip() + geom_line() + geom_vline(xintercept = mean(salary), color="red")
gg_salary
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip() +  geom_vline(xintercept = mean(salary), color="red")
gg_salary
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip() + geom_line() + geom_vline(xintercept = mean(salary), color="red")
gg_salary
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary, group = 1)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip() + geom_line() +  geom_vline(xintercept = mean(salary), color="red")
gg_salary
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary, group = 1)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip() + geom_line(xintercept = mean(salary), color="red")
gg_salary
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary, group = 1)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip()
gg_salary + geomvline(xintercept = mean(dat$salary), color = "red")
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary, group = 1)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip()
gg_salary + geom_vline(xintercept = mean(dat$salary), color = "red")
gg_salary
gg_salary <- gg_salary + geom_vline(xintercept = mean(dat$salary), color = "red")
gg_salary
gg_salary + geom_vline(xintercept = mean(dat$salary), color = "red")
gg_salary <- gg_salary + geom_vline(xintercept = mean(salary))
gg_salary
gg_salary <- gg_salary + geom_vline(xintercept = 2)
gg_salary
gg_salary <- gg_salary + geom_vline(yintercept = mean(salary))
gg_salary <- gg_salary + geom_hline(yintercept = mean(salary))
gg_salary
gg_salary <- gg_salary + geom_hline(xintercept = mean(salary))
gg_salary <- gg_salary + geom_hline(xintercept = mean(salary))
gg_salary <- gg_salary + geom_vline(xintercept = mean(salary))
gg_salary
gg_salary <- gg_salary + geom_vline(xintercept = mean(dat$salary))
gg_salary
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary, group = 1)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip()
gg_salary <- gg_salary + geom_vline(xintercept = mean(salary))
gg_salary
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary, group = 1)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip()
gg_salary <- gg_salary + geom_hline(xintercept = mean(salary))
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary, group = 1)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip()
gg_salary <- gg_salary + geom_hline(yintercept = mean(salary))
gg_salary
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary, group = 1)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip()
gg_salary
gg_salary <- gg_salary + geom_hline(yintercept = 2)
gg_salary
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary, group = 1)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip()
gg_salary <- gg_salary + geom_hline(yintercept = mean(teams$salary))
gg_salary
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary, group = 1)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip()
gg_salary <- gg_salary + geom_hline(yintercept = mean(teams$salary),color = "red")
gg_salary
gg_points <- ggplot(data = teams, aes(x =reorder(team, points) ,y =points, group = 1)) + labs(x= "Teams", y = "Points") +
geom_bar(stat='identity') + coord_flip()
gg_points <- gg_points + geom_hline(yintercept = mean(teams$points),color = "red")
gg_points
gg_eff <- ggplot(data = teams, aes(x =reorder(team, efficiency) ,y =efficiency, group = 1)) + labs(x= "Teams", y = "Points") +
geom_bar(stat='identity') + coord_flip()
gg_eff <- eff + geom_hline(yintercept = mean(teams$efficiency),color = "red")
gg_eff <- ggplot(data = teams, aes(x =reorder(team, efficiency) ,y =efficiency, group = 1)) + labs(x= "Teams", y = "Points") +
geom_bar(stat='identity') + coord_flip()
gg_eff
gg_eff <- gg_eff + geom_hline(yintercept = mean(teams$efficiency),color = "red")
gg_eff
prcomp
?prcomp
prcomp(teams)
prcomp(teams, scale = TRUE)
prcomp(teams, scale = TRUE, na.rm = TRUE)
prcomp(teams, scale = TRUE, na.rm = FALSE)
prcomp(teams, scale = TRUE)
prcomp(data = teams)
prcomp(teams)
prcomp(teams$points3)
prcomp(teams$points3)
prcomp(teams$points2)
prcomp(teams$free_throws)
prcomp(teams$off_rebounds)
prcomp(teams$points3, scale. = TRUE)
prcomp(teams$points2, scale. = TRUE)
prcomp(teams$points3, scale. = TRUE)
prcomp(teams$points2, scale. = TRUE)
prcomp(teams$free_throws,scale. = TRUE)
prcomp(teams$off_rebounds,scale. = TRUE)
prcomp(teams$def_rebounds,scale. = TRUE)
prcomp(teams$assists,scale. = TRUE)
prcomp(teams$steals,scale. = TRUE)
prcomp(teams$blocks,scale. = TRUE)
prcomp(teams$turnovers,scale. = TRUE)
prcomp(teams$fouls,scale. = TRUE)
x <- prcomp(teams$turnovers,scale. = TRUE)
x
lol <-prcomp(teams$turnovers,scale. = TRUE)
lol$x
names(x)
?cumsum
p3 <- prcomp(teams$points3, scale. = TRUE)
p2 <- prcomp(teams$points2, scale. = TRUE)
ft <- prcomp(teams$free_throws,scale. = TRUE)
or <- prcomp(teams$off_rebounds,scale. = TRUE)
dr <- prcomp(teams$def_rebounds,scale. = TRUE)
ass <- prcomp(teams$assists,scale. = TRUE)
sca <- prcomp(teams$steals,scale. = TRUE)
blo <- prcomp(teams$blocks,scale. = TRUE)
to <- lol <-prcomp(teams$turnovers,scale. = TRUE)
fol <- prcomp(teams$fouls,scale. = TRUE)
eigs <- data.frame(
eigenvalue = list(p3$sdev^2, p2$sdev^2, ft$sdev^2, or$sdev^2, dr$sdev^2, ass$sdev^2, sca$sdev^2, blo$sdev^2, to$sdev^2, fol$sdev^2),
)
eigs <- data.frame(
eigenvalue = list(p3$sdev^2, p2$sdev^2, ft$sdev^2, or$sdev^2, dr$sdev^2, ass$sdev^2, sca$sdev^2, blo$sdev^2, to$sdev^2, fol$sdev^2))
eigs
p3$sdev^2
p3 <- prcomp(teams, scale. = TRUE)
p2$sdev^2
prcomp(teams$points3, scale. = TRUE)
prcomp(teams$points3)
names(teams)
names(p3)
p3$sdev
p3$rotation
p3$center
p3$scale
p3$x
p3 <- prcomp(teams$points3, scale. = TRUE)
p3$x
p3$scale
p3$center
p3$rotation
p3$sdev
?prcomp
dsds
p3 <- prcomp(teams$points3, scale. = TRUE)
p3$x[,1]
temp <- prcomp(teams)
temp <- prcomp(teams, scale. = TRUE)
?prcomp
fol <- prcomp(teams$fouls,scale. = TRUE)
prcomp(teams, scale. = TRUE)
prcomp(dat, scale. = TRUE)
teams
pcateam <- select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls)
pcateam
pca <- prcomp(pcateam, scale.=TRUE)
pca
pca$pc1
pca$PC1
pca$x
pca$dev^2
eigenvalue = pca$sdev^2
eigenvalue
pccc <- pca$x[,1]
pccc
pca
pc1 <- pca[1,]
pc1 <- pca$PC1
pc1
pc1 <- pca$x[,1]
pc1
pca$x[,1]
names(pca)
pca
pca$cetner
pca$center
eigs <- data.frame(
eigenvalue = pca$sdev^2,
prop = round(100 * pca$sdev^2 / sum(pca$sdev^2), 3)
)
eigs
eigs <- data.frame(
eigenvalue = pca$sdev^2,
prop = round(pca$sdev^2 / sum(pca$sdev^2), 3)
)
eigs
eigs <- data.frame(
eigenvalue = pca$sdev^2,
prop = round(pca$sdev^2 / sum(pca$sdev^2), 5)
)
eigs
eigs <- data.frame(
eigenvalue = pca$sdev^2,
prop = round(pca$sdev^2 / sum(pca$sdev^2), 4)
)
eigs
eigs <- data.frame(
eigenvalue = pca$sdev^2,
prop = round(pca$sdev^2 / sum(pca$sdev^2), 4)
cprop = cumsum(prop)
)
eigs <- data.frame(
eigenvalue = pca$sdev^2,
prop = round(pca$sdev^2 / sum(pca$sdev^2), 4),
cprop = cumsum(prop)
)
eigenvalue = pca$sdev^2
prop = round(pca$sdev^2 / sum(pca$sdev^2), 4)
cprop = cumsum(prop)
eigs <- data.frame(
eigenvalue,
prop,
cprop
)
eigs
pca
pca$rotation
pca$rotation[PC1]
pca$rotation["PC1"]
pca$rotation[1:2,]
pca$rotation[1,]
pca$rotation[,1]
pc1 <- pca$rotation[,1]
pc2 <- pca$rotation[,2]
pc2
pc1
plot(pc1, pc2)
scatter.smooth()
pc1 <- pca$rotation[,1] * 10
pc2 <- pca$rotation[,2] * 10
scatter.smooth()
plot(pc1, pc2)
ggplot(pca, aes(x= pca$rotation[,1] * 10, y = pca$rotation[,2] * 10)) + geom_point()
ggplot(eigs, aes(x= pca$rotation[,1] * 10, y = pca$rotation[,2] * 10)) + geom_point()
ggplot(pc1, aes(x= pca$rotation[,1] * 10, y = pca$rotation[,2] * 10)) + geom_point()
plot(pc1, pc2, main = "Scatter of PC1 and PC2")
pc1
eisg
eigs
names(eigs)
?plot
s1 <- 100 * ((pc1 - min(pc1))/ max(pc1) - min(pc1))
s1
gg_eff
gg_points
s1 <- 100 * ((pc1 - min(pc1))/ max(pc1) - min(pc1))
gg_pc1 <- ggplot(data = teams, aes(x =reorder(pc1, s1) ,y =s1, group = 1)) + labs(x= "Team", y = "First PC (scaled from 0 to 100") +
geom_bar(stat='identity') + coord_flip()
gg_pc1
gg_pc1 <- ggplot(data = teams, aes(x = pc1 ,y =s1, group = 1)) + labs(x= "Team", y = "First PC (scaled from 0 to 100") +
geom_bar(stat='identity') + coord_flip()
gg_pc1
gg_pc1 <- ggplot(data = teams, aes(x =reorder(team, s1) ,y =s1, group = 1)) + labs(x= "Team", y = "First PC (scaled from 0 to 100") +
geom_bar(stat='identity') + coord_flip()
gg_pc1
s1 <- 100 * ((pc1 - min(pc1))/ max(pc1) - min(pc1))
gg_pc1 <- ggplot(data = teams, aes(x =reorder(team, s1) ,y =s1, group = 1)) + labs(x= "Team", y = "First PC (scaled from 0 to 100") +
geom_bar(stat='identity') + coord_flip()
gg_pc1
team
teamsgg_pc1 <- ggplot(data = teams, aes(x =reorder(teams$team, s1) ,y =s1, group = 1)) + labs(x= "Team", y = "First PC (scaled from 0 to 100") +
geom_bar(stat='identity') + coord_flip()
gg_pc1 <- ggplot(data = teams, aes(x =reorder(teams$team, s1) ,y =s1, group = 1)) + labs(x= "Team", y = "First PC (scaled from 0 to 100") +
geom_bar(stat='identity') + coord_flip()
gg_pc1
teams
teams$team
c1
s1
pc1
eigs
pca
pca$x
names(pca)
pca$x[,1]
pc1
pc1 <- pca$x[,1] * 10
pc2 <- pca$x[,2] * 10
plot(pc1, pc2, main = "Scatter of PC1 and PC2")
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
plot(pc1, pc2, main = "Scatter of PC1 and PC2")
?plot
plot(pc1, pc2, main = "Scatter of PC1 and PC2")
points(team$teams)
plot(pc1, pc2, main = "Scatter of PC1 and PC2")
points(teams$team)
?plot
plot(pc1, pc2, main = "Scatter of PC1 and PC2")
teams
team
teams
splot(pc1, pc2, main = "Scatter of PC1 and PC2")
text(pc1,pc2,labels=teams$team)
plot(pc1, pc2, main = "Scatter of PC1 and PC2")
text(pc1,pc2,labels=teams$team)
plot?
?
x
?plot
plot(pc1, pc2, main = "Scatter of PC1 and PC2", asp = 2)
text(pc1,pc2,labels=teams$team)
plot(pc1, pc2, main = "Scatter of PC1 and PC2", asp = 25)
text(pc1,pc2,labels=teams$team)
plot(pc1, pc2, main = "Scatter of PC1 and PC2", asp = 1)
text(pc1,pc2,labels=teams$team)
plot(pc1, pc2, main = "Scatter of PC1 and PC2", asp = .1)
text(pc1,pc2,labels=teams$team)
plot(pc1, pc2, main = "Scatter of PC1 and PC2", asp = .8)
text(pc1,pc2,labels=teams$team)
plot(pc1, pc2, main = "Scatter of PC1 and PC2", asp = .9)
text(pc1,pc2,labels=teams$team)
plot(pc1, pc2, main = "Scatter of PC1 and PC2")
text(pc1,pc2,labels=teams$team)
plot(pc1, pc2, main = "Scatter of PC1 and PC2", cex = 1)
text(pc1,pc2,labels=teams$team)
plot(pc1, pc2, main = "Scatter of PC1 and PC2", cex = .1)
text(pc1,pc2,labels=teams$team)
plot(pc1, pc2, main = "Scatter of PC1 and PC2", cex = 0)
text(pc1,pc2,labels=teams$team)
gg_pc1 <- ggplot(data = pca, aes(x =reorder(teams$team, s1) ,y =s1, group = 1)) + labs(x= "Team", y = "First PC (scaled from 0 to 100") +
gg_pc1 <- ggplot(data = pca, aes(x =reorder(teams$team, s1) ,y =s1, group = 1)) + labs(x= "Team", y = "First PC (scaled from 0 to 100") +
geom_bar(stat='identity') + coord_flip()
gg_pc1
gg_pc1 <- ggplot(data = teams, aes(x =reorder(teams$team, s1) ,y =s1, group = 1)) + labs(x= "Team", y = "First PC (scaled from 0 to 100") +
geom_bar(stat='identity') + coord_flip()
gg_pc1
s1 <- 100 * ((pc1 - min(pc1))/ max(pc1) - min(pc1))
s
s1
gg_pc1 <- ggplot(data = teams, aes(x =reorder(teams$team, s1) ,y =s1, group = 1)) + labs(x= "Team", y = "First PC (scaled from 0 to 100") +
geom_bar(stat='identity') + coord_flip()
gg_pc1
knitr::opts_chunk$set(echo = TRUE)
source('/Users/Roberto/Desktop/133/stat133-hws-fall17/hw03/code/make-teams-table.R')
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary, group = 1)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip()
gg_salary <- gg_salary + geom_hline(yintercept = mean(teams$salary),color = "red")
gg_salary
gg_points <- ggplot(data = teams, aes(x =reorder(team, points) ,y =points, group = 1)) + labs(x= "Teams", y = "Points") +
geom_bar(stat='identity') + coord_flip()
gg_points <- gg_points + geom_hline(yintercept = mean(teams$points),color = "red")
gg_points
gg_eff <- ggplot(data = teams, aes(x =reorder(team, efficiency) ,y =efficiency, group = 1)) + labs(x= "Teams", y = "Points") +
geom_bar(stat='identity') + coord_flip()
gg_eff <- gg_eff + geom_hline(yintercept = mean(teams$efficiency),color = "red")
gg_eff
pcateam <- select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls)
pca <- prcomp(pcateam, scale.=TRUE)
pca
eigenvalue = pca$sdev^2
prop = round(pca$sdev^2 / sum(pca$sdev^2), 4)
cprop = cumsum(prop)
eigs <- data.frame(
eigenvalue,
prop,
cprop
)
eigs
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
plot(pc1, pc2, main = "Scatter of PC1 and PC2", cex = 0)
text(pc1,pc2,labels=teams$team)
s1 <- 100 * ((pc1 - min(pc1))/ max(pc1) - min(pc1))
gg_pc1 <- ggplot(data = teams, aes(x =reorder(teams$team, s1) ,y =s1, group = 1)) + labs(x= "Team", y = "First PC (scaled from 0 to 100") +
geom_bar(stat='identity') + coord_flip()
gg_pc1
source('/Users/Roberto/Desktop/133/stat133-hws-fall17/hw03/code/make-teams-table.R')
gg_salary <- ggplot(data = teams, aes(x =reorder(team, salary) ,y =salary, group = 1)) + labs(x= "Teams", y = "Salary") +
geom_bar(stat='identity') + coord_flip()
gg_salary <- gg_salary + geom_hline(yintercept = mean(teams$salary),color = "red")
gg_salary
gg_points <- ggplot(data = teams, aes(x =reorder(team, points) ,y =points, group = 1)) + labs(x= "Teams", y = "Points") +
geom_bar(stat='identity') + coord_flip()
gg_points <- gg_points + geom_hline(yintercept = mean(teams$points),color = "red")
gg_points
gg_eff <- ggplot(data = teams, aes(x =reorder(team, efficiency) ,y =efficiency, group = 1)) + labs(x= "Teams", y = "Points") +
geom_bar(stat='identity') + coord_flip()
gg_eff <- gg_eff + geom_hline(yintercept = mean(teams$efficiency),color = "red")
gg_eff
pcateam <- select(teams, points3, points2, free_throws, off_rebounds, def_rebounds, assists, steals, blocks, turnovers, fouls)
pca <- prcomp(pcateam, scale.=TRUE)
pca
eigenvalue = pca$sdev^2
prop = round(pca$sdev^2 / sum(pca$sdev^2), 4)
cprop = cumsum(prop)
eigs <- data.frame(
eigenvalue,
prop,
cprop
)
eigs
pc1 <- pca$x[,1]
pc2 <- pca$x[,2]
plot(pc1, pc2, main = "Scatter of PC1 and PC2", cex = 0)
text(pc1,pc2,labels=teams$team)
s1 <- 100 * ((pc1 - min(pc1))/ max(pc1) - min(pc1))
gg_pc1 <- ggplot(data = teams, aes(x =reorder(teams$team, s1) ,y =s1, group = 1)) + labs(x= "Team", y = "First PC (scaled from 0 to 100") +
geom_bar(stat='identity') + coord_flip()
gg_pc1
jghg
knitr::opts_chunk$set(echo = TRUE)
source('/Users/Roberto/Desktop/133/stat133-hws-fall17/hw03/code/make-teams-table.R')
write.csv(teams, file = '/Users/Roberto/Desktop/133/stat133-hws-fall17/hw03/data/nba2017-teams.cvs', row.names = FALSE)
